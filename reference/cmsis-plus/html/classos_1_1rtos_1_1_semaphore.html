<!-- HTML header for doxygen 1.8.11-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>CMSIS++ Reference: os::rtos::Semaphore Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><a href="$relpath/../../../.."><img alt="Logo" src="logo.png"/></a></td>
  <td id="projectalign">
   <div>
     <div id="projectname">CMSIS++ Reference
     &#160;<span id="projectnumber">0.1.1</span>
     </div>
     <div id="projectmotto" class="float:right;">“Perfekt ist nicht gut genug”</div>
     </div>  
   </div>
   <div id="projectbrief">CMSIS++: A proposal for the next generation CMSIS, written in C++.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classos_1_1rtos_1_1_semaphore.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="classos_1_1rtos_1_1_semaphore-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">os::rtos::Semaphore Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>POSIX semaphore.  
 <a href="classos_1_1rtos_1_1_semaphore.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="os_8h_source.html">os.h</a>&gt;</code></p>

<p>Inherits <a class="el" href="classos_1_1rtos_1_1_named__object.html">os::rtos::Named_object</a>.</p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ad8b005eb3618fb0c9b5fa7eeda019a0d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classos_1_1rtos_1_1_semaphore.html#ad8b005eb3618fb0c9b5fa7eeda019a0d">Semaphore</a> ()</td></tr>
<tr class="memdesc:ad8b005eb3618fb0c9b5fa7eeda019a0d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a default semaphore.  <a href="#ad8b005eb3618fb0c9b5fa7eeda019a0d">More...</a><br /></td></tr>
<tr class="separator:ad8b005eb3618fb0c9b5fa7eeda019a0d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a016fd0cc042a53b898ba8c18a250fcbc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classos_1_1rtos_1_1_semaphore.html#a016fd0cc042a53b898ba8c18a250fcbc">Semaphore</a> (const <a class="el" href="classos_1_1rtos_1_1semaphore_1_1_attributes.html">semaphore::Attributes</a> &amp;<a class="el" href="os-main_8cpp.html#afa497dd39af40726a08466395f5bb084">attr</a>)</td></tr>
<tr class="memdesc:a016fd0cc042a53b898ba8c18a250fcbc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create custom semaphore.  <a href="#a016fd0cc042a53b898ba8c18a250fcbc">More...</a><br /></td></tr>
<tr class="separator:a016fd0cc042a53b898ba8c18a250fcbc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae081923eedd56401905830a981063be7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classos_1_1rtos_1_1_semaphore.html#ae081923eedd56401905830a981063be7">Semaphore</a> (const <a class="el" href="classos_1_1rtos_1_1_semaphore.html">Semaphore</a> &amp;)=delete</td></tr>
<tr class="separator:ae081923eedd56401905830a981063be7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3774e6f34c8f64d0f927853bbcc25cd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classos_1_1rtos_1_1_semaphore.html#ae3774e6f34c8f64d0f927853bbcc25cd">Semaphore</a> (<a class="el" href="classos_1_1rtos_1_1_semaphore.html">Semaphore</a> &amp;&amp;)=delete</td></tr>
<tr class="separator:ae3774e6f34c8f64d0f927853bbcc25cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afad6784d1a323aa1e9b8f07513950aca"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classos_1_1rtos_1_1_semaphore.html">Semaphore</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classos_1_1rtos_1_1_semaphore.html#afad6784d1a323aa1e9b8f07513950aca">operator=</a> (const <a class="el" href="classos_1_1rtos_1_1_semaphore.html">Semaphore</a> &amp;)=delete</td></tr>
<tr class="separator:afad6784d1a323aa1e9b8f07513950aca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ae185ebe3909b86d5b531d34664ca94"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classos_1_1rtos_1_1_semaphore.html">Semaphore</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classos_1_1rtos_1_1_semaphore.html#a4ae185ebe3909b86d5b531d34664ca94">operator=</a> (<a class="el" href="classos_1_1rtos_1_1_semaphore.html">Semaphore</a> &amp;&amp;)=delete</td></tr>
<tr class="separator:a4ae185ebe3909b86d5b531d34664ca94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c4f278ca1cfb213b416f31720a30f04"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classos_1_1rtos_1_1_semaphore.html#a4c4f278ca1cfb213b416f31720a30f04">~Semaphore</a> ()</td></tr>
<tr class="memdesc:a4c4f278ca1cfb213b416f31720a30f04"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destroy the semaphore.  <a href="#a4c4f278ca1cfb213b416f31720a30f04">More...</a><br /></td></tr>
<tr class="separator:a4c4f278ca1cfb213b416f31720a30f04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0e0c778fd520d792ce171ed0568ed28"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classos_1_1rtos_1_1_semaphore.html#ae0e0c778fd520d792ce171ed0568ed28">operator==</a> (const <a class="el" href="classos_1_1rtos_1_1_semaphore.html">Semaphore</a> &amp;rhs) const </td></tr>
<tr class="memdesc:ae0e0c778fd520d792ce171ed0568ed28"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compare semaphores.  <a href="#ae0e0c778fd520d792ce171ed0568ed28">More...</a><br /></td></tr>
<tr class="separator:ae0e0c778fd520d792ce171ed0568ed28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add305af99c6d539ca210cd88cdc0c295"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceos_1_1rtos.html#a54633089ccffe9e56ce1137ebe57776d">result_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classos_1_1rtos_1_1_semaphore.html#add305af99c6d539ca210cd88cdc0c295">post</a> (void)</td></tr>
<tr class="memdesc:add305af99c6d539ca210cd88cdc0c295"><td class="mdescLeft">&#160;</td><td class="mdescRight">Post (unlock) the semaphore.  <a href="#add305af99c6d539ca210cd88cdc0c295">More...</a><br /></td></tr>
<tr class="separator:add305af99c6d539ca210cd88cdc0c295"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2740c2b8f9f596cc6255599068f20f98"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceos_1_1rtos.html#a54633089ccffe9e56ce1137ebe57776d">result_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classos_1_1rtos_1_1_semaphore.html#a2740c2b8f9f596cc6255599068f20f98">wait</a> ()</td></tr>
<tr class="memdesc:a2740c2b8f9f596cc6255599068f20f98"><td class="mdescLeft">&#160;</td><td class="mdescRight">Lock the semaphore, possibly waiting.  <a href="#a2740c2b8f9f596cc6255599068f20f98">More...</a><br /></td></tr>
<tr class="separator:a2740c2b8f9f596cc6255599068f20f98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27f748424126707fde0cc1de41c01a48"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceos_1_1rtos.html#a54633089ccffe9e56ce1137ebe57776d">result_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classos_1_1rtos_1_1_semaphore.html#a27f748424126707fde0cc1de41c01a48">try_wait</a> ()</td></tr>
<tr class="memdesc:a27f748424126707fde0cc1de41c01a48"><td class="mdescLeft">&#160;</td><td class="mdescRight">Try to lock the semaphore.  <a href="#a27f748424126707fde0cc1de41c01a48">More...</a><br /></td></tr>
<tr class="separator:a27f748424126707fde0cc1de41c01a48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13155e1bf1c700001f0ee6a7f39ec6ff"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceos_1_1rtos.html#a54633089ccffe9e56ce1137ebe57776d">result_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classos_1_1rtos_1_1_semaphore.html#a13155e1bf1c700001f0ee6a7f39ec6ff">timed_wait</a> (<a class="el" href="namespaceos_1_1rtos.html#aba7f568590671eed574e70d3a38de2df">systicks_t</a> ticks)</td></tr>
<tr class="memdesc:a13155e1bf1c700001f0ee6a7f39ec6ff"><td class="mdescLeft">&#160;</td><td class="mdescRight">Timed wait to lock the semaphore.  <a href="#a13155e1bf1c700001f0ee6a7f39ec6ff">More...</a><br /></td></tr>
<tr class="separator:a13155e1bf1c700001f0ee6a7f39ec6ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afaad1f1047d7d46f5baf5329d35ca78d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceos_1_1rtos_1_1semaphore.html#af1d385ca401f753ae725118254291409">semaphore::count_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classos_1_1rtos_1_1_semaphore.html#afaad1f1047d7d46f5baf5329d35ca78d">value</a> (void) const </td></tr>
<tr class="memdesc:afaad1f1047d7d46f5baf5329d35ca78d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the semaphore value.  <a href="#afaad1f1047d7d46f5baf5329d35ca78d">More...</a><br /></td></tr>
<tr class="separator:afaad1f1047d7d46f5baf5329d35ca78d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad855a37723270b019c47cc90d23cddff"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceos_1_1rtos.html#a54633089ccffe9e56ce1137ebe57776d">result_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classos_1_1rtos_1_1_semaphore.html#ad855a37723270b019c47cc90d23cddff">reset</a> (void)</td></tr>
<tr class="memdesc:ad855a37723270b019c47cc90d23cddff"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset the semaphore.  <a href="#ad855a37723270b019c47cc90d23cddff">More...</a><br /></td></tr>
<tr class="separator:ad855a37723270b019c47cc90d23cddff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ed399e5c96ee44445fa8b7745665b11"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceos_1_1rtos_1_1semaphore.html#af1d385ca401f753ae725118254291409">semaphore::count_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classos_1_1rtos_1_1_semaphore.html#a4ed399e5c96ee44445fa8b7745665b11">initial_value</a> (void) const </td></tr>
<tr class="separator:a4ed399e5c96ee44445fa8b7745665b11"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0892c8cd78d99100a3cb17e797cd17c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceos_1_1rtos_1_1semaphore.html#af1d385ca401f753ae725118254291409">semaphore::count_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classos_1_1rtos_1_1_semaphore.html#ab0892c8cd78d99100a3cb17e797cd17c">max_value</a> (void) const </td></tr>
<tr class="separator:ab0892c8cd78d99100a3cb17e797cd17c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ced578ffc847e14547b02ee1473c44e"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classos_1_1rtos_1_1_named__object.html#a1ced578ffc847e14547b02ee1473c44e">name</a> (void) const </td></tr>
<tr class="separator:a1ced578ffc847e14547b02ee1473c44e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a1b69a387f9889eca15969d326cbaeb45"><td class="memItemLeft" align="right" valign="top">port::Tasks_list&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classos_1_1rtos_1_1_semaphore.html#a1b69a387f9889eca15969d326cbaeb45">list_</a></td></tr>
<tr class="separator:a1b69a387f9889eca15969d326cbaeb45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1038bfe269c0f83b11b9c8c359c24640"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="namespaceos_1_1rtos_1_1semaphore.html#af1d385ca401f753ae725118254291409">semaphore::count_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classos_1_1rtos_1_1_semaphore.html#a1038bfe269c0f83b11b9c8c359c24640">initial_count_</a></td></tr>
<tr class="separator:a1038bfe269c0f83b11b9c8c359c24640"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7a6486c35b35956d9a0fb729719121a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="semihosting_8h.html#a32ef937c1076c2ef6b0f929bc187c1cb">volatile</a> <a class="el" href="namespaceos_1_1rtos_1_1semaphore.html#af1d385ca401f753ae725118254291409">semaphore::count_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classos_1_1rtos_1_1_semaphore.html#ad7a6486c35b35956d9a0fb729719121a">count_</a></td></tr>
<tr class="separator:ad7a6486c35b35956d9a0fb729719121a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a189e07ad643c937c8f705bce4c48bac1"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="namespaceos_1_1rtos_1_1semaphore.html#af1d385ca401f753ae725118254291409">semaphore::count_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classos_1_1rtos_1_1_semaphore.html#a189e07ad643c937c8f705bce4c48bac1">max_count_</a></td></tr>
<tr class="separator:a189e07ad643c937c8f705bce4c48bac1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c6435f5bbc1c2793664672cbf420d70"><td class="memItemLeft" align="right" valign="top">const char *const&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classos_1_1rtos_1_1_named__object.html#a7c6435f5bbc1c2793664672cbf420d70">name_</a></td></tr>
<tr class="separator:a7c6435f5bbc1c2793664672cbf420d70"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>POSIX semaphore. </p>
<p>Supports both counting and binary semaphores.</p>
<p>Semaphores should generally be used to synchronise with events occuring on interrupts.</p>
<p>For inter-thread synchronisation, to avoid cases of priority inversion, more suitable are mutexes.</p>
<p>Compatible with POSIX semaphores. <a href="http://pubs.opengroup.org/onlinepubs/9699919799/basedefs/semaphore.h.html">http://pubs.opengroup.org/onlinepubs/9699919799/basedefs/semaphore.h.html</a> </p>

<p>Definition at line <a class="el" href="os_8h_source.html#l01611">1611</a> of file <a class="el" href="os_8h_source.html">os.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="ad8b005eb3618fb0c9b5fa7eeda019a0d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">os::rtos::Semaphore::Semaphore </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a default semaphore. </p>
<p>Create and initialise a semaphore with default attributes. Initialise the semaphore with count=0 and no limit for count.</p>
<p>Compatible with POSIX <code>sem_init()</code>. <a href="http://pubs.opengroup.org/onlinepubs/9699919799/functions/sem_init.html#">http://pubs.opengroup.org/onlinepubs/9699919799/functions/sem_init.html#</a></p>
<dl class="section warning"><dt>Warning</dt><dd>Cannot be invoked from Interrupt Service Routines. </dd></dl>

<p>Definition at line <a class="el" href="os-semaphore_8cpp_source.html#l00061">61</a> of file <a class="el" href="os-semaphore_8cpp_source.html">os-semaphore.cpp</a>.</p>

<p>References <a class="el" href="os-semaphore_8cpp_source.html#l00042">os::rtos::semaphore::counting_initializer</a>.</p>
<div class="fragment"><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;                          :</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        <a class="code" href="classos_1_1rtos_1_1_semaphore.html#ad8b005eb3618fb0c9b5fa7eeda019a0d">Semaphore</a></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;          { <a class="code" href="namespaceos_1_1rtos_1_1semaphore.html#ac33390c32b3c72523e40ff8816b06d58">semaphore::counting_initializer</a> }</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    {</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      ;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    }</div><div class="ttc" id="namespaceos_1_1rtos_1_1semaphore_html_ac33390c32b3c72523e40ff8816b06d58"><div class="ttname"><a href="namespaceos_1_1rtos_1_1semaphore.html#ac33390c32b3c72523e40ff8816b06d58">os::rtos::semaphore::counting_initializer</a></div><div class="ttdeci">const Attributes counting_initializer</div><div class="ttdef"><b>Definition:</b> <a href="os-semaphore_8cpp_source.html#l00042">os-semaphore.cpp:42</a></div></div>
<div class="ttc" id="classos_1_1rtos_1_1_semaphore_html_ad8b005eb3618fb0c9b5fa7eeda019a0d"><div class="ttname"><a href="classos_1_1rtos_1_1_semaphore.html#ad8b005eb3618fb0c9b5fa7eeda019a0d">os::rtos::Semaphore::Semaphore</a></div><div class="ttdeci">Semaphore()</div><div class="ttdoc">Create a default semaphore. </div><div class="ttdef"><b>Definition:</b> <a href="os-semaphore_8cpp_source.html#l00061">os-semaphore.cpp:61</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a016fd0cc042a53b898ba8c18a250fcbc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">os::rtos::Semaphore::Semaphore </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classos_1_1rtos_1_1semaphore_1_1_attributes.html">semaphore::Attributes</a> &amp;&#160;</td>
          <td class="paramname"><em>attr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create custom semaphore. </p>
<p>Create and initialise a semaphore with custom attributes.</p>
<p>Compatible with POSIX <code>sem_init()</code>. <a href="http://pubs.opengroup.org/onlinepubs/9699919799/functions/sem_init.html#">http://pubs.opengroup.org/onlinepubs/9699919799/functions/sem_init.html#</a></p>
<dl class="section warning"><dt>Warning</dt><dd>Cannot be invoked from Interrupt Service Routines. </dd></dl>

<p>Definition at line <a class="el" href="os-semaphore_8cpp_source.html#l00077">77</a> of file <a class="el" href="os-semaphore_8cpp_source.html">os-semaphore.cpp</a>.</p>

<p>References <a class="el" href="os-main_8cpp_source.html#l00084">attr</a>, <a class="el" href="os_8h_source.html#l01732">count_</a>, <a class="el" href="os-core_8cpp_source.html#l00068">os::rtos::scheduler::in_handler_mode()</a>, <a class="el" href="os_8h_source.html#l01729">initial_count_</a>, <a class="el" href="os_8h_source.html#l01735">max_count_</a>, <a class="el" href="os_8h_source.html#l02531">os::rtos::Named_object::name()</a>, <a class="el" href="os_8h_source.html#l03039">os_assert_throw</a>, and <a class="el" href="namespaceos_1_1trace.html#ab99139b69af4fe6f063b4a236133b2ee">os::trace::printf()</a>.</p>
<div class="fragment"><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                                                         :</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        <a class="code" href="classos_1_1rtos_1_1_named__object.html#a1af2fd6d40c45916ecbb2713e39bf7da">Named_object</a></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;          { <a class="code" href="os-main_8cpp.html#afa497dd39af40726a08466395f5bb084">attr</a>.name () }, <span class="comment">//</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        <a class="code" href="classos_1_1rtos_1_1_semaphore.html#a1038bfe269c0f83b11b9c8c359c24640">initial_count_</a> (<a class="code" href="os-main_8cpp.html#afa497dd39af40726a08466395f5bb084">attr</a>.sm_initial_count), <span class="comment">//</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <a class="code" href="classos_1_1rtos_1_1_semaphore.html#a189e07ad643c937c8f705bce4c48bac1">max_count_</a> (<a class="code" href="os-main_8cpp.html#afa497dd39af40726a08466395f5bb084">attr</a>.sm_max_count)</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    {</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      <a class="code" href="os_8h.html#a7ca7d74dfe5c184cdd627cc958564137">os_assert_throw</a>(!<a class="code" href="namespaceos_1_1rtos_1_1scheduler.html#a72474ad9ad219abeb13fb3ed0b95a8b3">scheduler::in_handler_mode</a> (), EPERM);</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      <span class="comment">// The CMSIS validator requires the max_count to be equal to</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      <span class="comment">// the initial count, which can be 0, but we patch it on the way.</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      assert(<a class="code" href="classos_1_1rtos_1_1_semaphore.html#a189e07ad643c937c8f705bce4c48bac1">max_count_</a> &gt; 0);</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      assert(<a class="code" href="os-main_8cpp.html#afa497dd39af40726a08466395f5bb084">attr</a>.sm_initial_count &lt;= <a class="code" href="classos_1_1rtos_1_1_semaphore.html#a189e07ad643c937c8f705bce4c48bac1">max_count_</a>);</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;      <a class="code" href="classos_1_1rtos_1_1_semaphore.html#ad7a6486c35b35956d9a0fb729719121a">count_</a> = <a class="code" href="os-main_8cpp.html#afa497dd39af40726a08466395f5bb084">attr</a>.sm_initial_count;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      <span class="comment">// TODO check if initial count can be negative, to validate.</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;      <a class="code" href="namespaceos_1_1trace.html#ab99139b69af4fe6f063b4a236133b2ee">trace::printf</a> (<span class="stringliteral">&quot;%s() @%p %s %d %d\n&quot;</span>, __func__, <span class="keyword">this</span>, <a class="code" href="classos_1_1rtos_1_1_named__object.html#a1ced578ffc847e14547b02ee1473c44e">name</a> (), <a class="code" href="classos_1_1rtos_1_1_semaphore.html#ad7a6486c35b35956d9a0fb729719121a">count_</a>,</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                     <a class="code" href="classos_1_1rtos_1_1_semaphore.html#a189e07ad643c937c8f705bce4c48bac1">max_count_</a>);</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="preprocessor">#if defined(OS_INCLUDE_PORT_RTOS_SEMAPHORE)</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;      port::Semaphore::create (<span class="keyword">this</span>);</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      <span class="comment">// TODO</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    }</div><div class="ttc" id="classos_1_1rtos_1_1_named__object_html_a1ced578ffc847e14547b02ee1473c44e"><div class="ttname"><a href="classos_1_1rtos_1_1_named__object.html#a1ced578ffc847e14547b02ee1473c44e">os::rtos::Named_object::name</a></div><div class="ttdeci">const char * name(void) const </div><div class="ttdef"><b>Definition:</b> <a href="os_8h_source.html#l02531">os.h:2531</a></div></div>
<div class="ttc" id="classos_1_1rtos_1_1_semaphore_html_a1038bfe269c0f83b11b9c8c359c24640"><div class="ttname"><a href="classos_1_1rtos_1_1_semaphore.html#a1038bfe269c0f83b11b9c8c359c24640">os::rtos::Semaphore::initial_count_</a></div><div class="ttdeci">const semaphore::count_t initial_count_</div><div class="ttdef"><b>Definition:</b> <a href="os_8h_source.html#l01729">os.h:1729</a></div></div>
<div class="ttc" id="classos_1_1rtos_1_1_named__object_html_a1af2fd6d40c45916ecbb2713e39bf7da"><div class="ttname"><a href="classos_1_1rtos_1_1_named__object.html#a1af2fd6d40c45916ecbb2713e39bf7da">os::rtos::Named_object::Named_object</a></div><div class="ttdeci">Named_object(const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="os-core_8cpp_source.html#l00175">os-core.cpp:175</a></div></div>
<div class="ttc" id="os-main_8cpp_html_afa497dd39af40726a08466395f5bb084"><div class="ttname"><a href="os-main_8cpp.html#afa497dd39af40726a08466395f5bb084">attr</a></div><div class="ttdeci">static thread::Attributes attr</div><div class="ttdef"><b>Definition:</b> <a href="os-main_8cpp_source.html#l00084">os-main.cpp:84</a></div></div>
<div class="ttc" id="classos_1_1rtos_1_1_semaphore_html_a189e07ad643c937c8f705bce4c48bac1"><div class="ttname"><a href="classos_1_1rtos_1_1_semaphore.html#a189e07ad643c937c8f705bce4c48bac1">os::rtos::Semaphore::max_count_</a></div><div class="ttdeci">const semaphore::count_t max_count_</div><div class="ttdef"><b>Definition:</b> <a href="os_8h_source.html#l01735">os.h:1735</a></div></div>
<div class="ttc" id="os_8h_html_a7ca7d74dfe5c184cdd627cc958564137"><div class="ttname"><a href="os_8h.html#a7ca7d74dfe5c184cdd627cc958564137">os_assert_throw</a></div><div class="ttdeci">#define os_assert_throw(__e, __er)</div><div class="ttdef"><b>Definition:</b> <a href="os_8h_source.html#l03039">os.h:3039</a></div></div>
<div class="ttc" id="namespaceos_1_1rtos_1_1scheduler_html_a72474ad9ad219abeb13fb3ed0b95a8b3"><div class="ttname"><a href="namespaceos_1_1rtos_1_1scheduler.html#a72474ad9ad219abeb13fb3ed0b95a8b3">os::rtos::scheduler::in_handler_mode</a></div><div class="ttdeci">bool in_handler_mode(void)</div><div class="ttdoc">Check if in handler mode. </div><div class="ttdef"><b>Definition:</b> <a href="os-core_8cpp_source.html#l00068">os-core.cpp:68</a></div></div>
<div class="ttc" id="namespaceos_1_1trace_html_ab99139b69af4fe6f063b4a236133b2ee"><div class="ttname"><a href="namespaceos_1_1trace.html#ab99139b69af4fe6f063b4a236133b2ee">os::trace::printf</a></div><div class="ttdeci">int printf(const char *format,...)</div></div>
<div class="ttc" id="classos_1_1rtos_1_1_semaphore_html_ad7a6486c35b35956d9a0fb729719121a"><div class="ttname"><a href="classos_1_1rtos_1_1_semaphore.html#ad7a6486c35b35956d9a0fb729719121a">os::rtos::Semaphore::count_</a></div><div class="ttdeci">volatile semaphore::count_t count_</div><div class="ttdef"><b>Definition:</b> <a href="os_8h_source.html#l01732">os.h:1732</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae081923eedd56401905830a981063be7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">os::rtos::Semaphore::Semaphore </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classos_1_1rtos_1_1_semaphore.html">Semaphore</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ae3774e6f34c8f64d0f927853bbcc25cd"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">os::rtos::Semaphore::Semaphore </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classos_1_1rtos_1_1_semaphore.html">Semaphore</a> &amp;&amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a4c4f278ca1cfb213b416f31720a30f04"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">os::rtos::Semaphore::~Semaphore </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Destroy the semaphore. </p>
<p>It is safe to destroy an initialised semaphore upon which no threads are currently blocked. The effect of destroying a semaphore upon which other threads are currently blocked is undefined.</p>
<p>Compatible with POSIX <code>sem_destroy()</code>. <a href="http://pubs.opengroup.org/onlinepubs/9699919799/functions/sem_destroy.html">http://pubs.opengroup.org/onlinepubs/9699919799/functions/sem_destroy.html</a></p>
<dl class="section warning"><dt>Warning</dt><dd>Cannot be invoked from Interrupt Service Routines. </dd></dl>

<p>Definition at line <a class="el" href="os-semaphore_8cpp_source.html#l00120">120</a> of file <a class="el" href="os-semaphore_8cpp_source.html">os-semaphore.cpp</a>.</p>

<p>References <a class="el" href="os_8h_source.html#l02531">os::rtos::Named_object::name()</a>, and <a class="el" href="namespaceos_1_1trace.html#ab99139b69af4fe6f063b4a236133b2ee">os::trace::printf()</a>.</p>
<div class="fragment"><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    {</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      <a class="code" href="namespaceos_1_1trace.html#ab99139b69af4fe6f063b4a236133b2ee">trace::printf</a> (<span class="stringliteral">&quot;%s() @%p %s\n&quot;</span>, __func__, <span class="keyword">this</span>, <a class="code" href="classos_1_1rtos_1_1_named__object.html#a1ced578ffc847e14547b02ee1473c44e">name</a> ());</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="preprocessor">#if defined(OS_INCLUDE_PORT_RTOS_SEMAPHORE)</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      port::Semaphore::destroy (<span class="keyword">this</span>);</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      <span class="comment">// TODO</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    }</div><div class="ttc" id="classos_1_1rtos_1_1_named__object_html_a1ced578ffc847e14547b02ee1473c44e"><div class="ttname"><a href="classos_1_1rtos_1_1_named__object.html#a1ced578ffc847e14547b02ee1473c44e">os::rtos::Named_object::name</a></div><div class="ttdeci">const char * name(void) const </div><div class="ttdef"><b>Definition:</b> <a href="os_8h_source.html#l02531">os.h:2531</a></div></div>
<div class="ttc" id="namespaceos_1_1trace_html_ab99139b69af4fe6f063b4a236133b2ee"><div class="ttname"><a href="namespaceos_1_1trace.html#ab99139b69af4fe6f063b4a236133b2ee">os::trace::printf</a></div><div class="ttdeci">int printf(const char *format,...)</div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a4ed399e5c96ee44445fa8b7745665b11"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceos_1_1rtos_1_1semaphore.html#af1d385ca401f753ae725118254291409">semaphore::count_t</a> os::rtos::Semaphore::initial_value </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="os_8h_source.html#l02857">2857</a> of file <a class="el" href="os_8h_source.html">os.h</a>.</p>
<div class="fragment"><div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;    {</div><div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classos_1_1rtos_1_1_semaphore.html#a1038bfe269c0f83b11b9c8c359c24640">initial_count_</a>;</div><div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;    }</div><div class="ttc" id="classos_1_1rtos_1_1_semaphore_html_a1038bfe269c0f83b11b9c8c359c24640"><div class="ttname"><a href="classos_1_1rtos_1_1_semaphore.html#a1038bfe269c0f83b11b9c8c359c24640">os::rtos::Semaphore::initial_count_</a></div><div class="ttdeci">const semaphore::count_t initial_count_</div><div class="ttdef"><b>Definition:</b> <a href="os_8h_source.html#l01729">os.h:1729</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab0892c8cd78d99100a3cb17e797cd17c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceos_1_1rtos_1_1semaphore.html#af1d385ca401f753ae725118254291409">semaphore::count_t</a> os::rtos::Semaphore::max_value </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="os_8h_source.html#l02863">2863</a> of file <a class="el" href="os_8h_source.html">os.h</a>.</p>
<div class="fragment"><div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;    {</div><div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classos_1_1rtos_1_1_semaphore.html#a189e07ad643c937c8f705bce4c48bac1">max_count_</a>;</div><div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;    }</div><div class="ttc" id="classos_1_1rtos_1_1_semaphore_html_a189e07ad643c937c8f705bce4c48bac1"><div class="ttname"><a href="classos_1_1rtos_1_1_semaphore.html#a189e07ad643c937c8f705bce4c48bac1">os::rtos::Semaphore::max_count_</a></div><div class="ttdeci">const semaphore::count_t max_count_</div><div class="ttdef"><b>Definition:</b> <a href="os_8h_source.html#l01735">os.h:1735</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1ced578ffc847e14547b02ee1473c44e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const char * os::rtos::Named_object::name </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="os_8h_source.html#l02531">2531</a> of file <a class="el" href="os_8h_source.html">os.h</a>.</p>

<p>Referenced by <a class="el" href="os-thread_8cpp_source.html#l00267">os::rtos::Thread::_destroy()</a>, <a class="el" href="os-thread_8cpp_source.html#l00152">os::rtos::Thread::_invoke_with_exit()</a>, <a class="el" href="os-mempool_8cpp_source.html#l00153">os::rtos::Memory_pool::alloc()</a>, <a class="el" href="os-thread_8cpp_source.html#l00528">os::rtos::Thread::cancel()</a>, <a class="el" href="os-condvar_8cpp_source.html#l00068">os::rtos::Condition_variable::Condition_variable()</a>, <a class="el" href="os-thread_8cpp_source.html#l00490">os::rtos::Thread::detach()</a>, <a class="el" href="os-evflags_8cpp_source.html#l00068">os::rtos::Event_flags::Event_flags()</a>, <a class="el" href="os-thread_8cpp_source.html#l00580">os::rtos::Thread::exit()</a>, <a class="el" href="os-mempool_8cpp_source.html#l00287">os::rtos::Memory_pool::free()</a>, <a class="el" href="os-thread_8cpp_source.html#l00449">os::rtos::Thread::join()</a>, <a class="el" href="os-thread_8cpp_source.html#l00611">os::rtos::Thread::kill()</a>, <a class="el" href="os-mempool_8cpp_source.html#l00066">os::rtos::Memory_pool::Memory_pool()</a>, <a class="el" href="os-mqueue_8cpp_source.html#l00063">os::rtos::Message_queue::Message_queue()</a>, <a class="el" href="os-mutex_8cpp_source.html#l00081">os::rtos::Mutex::Mutex()</a>, <a class="el" href="os-semaphore_8cpp_source.html#l00171">post()</a>, <a class="el" href="os-mqueue_8cpp_source.html#l00327">os::rtos::Message_queue::receive()</a>, <a class="el" href="os-mempool_8cpp_source.html#l00328">os::rtos::Memory_pool::reset()</a>, <a class="el" href="os-mqueue_8cpp_source.html#l00484">os::rtos::Message_queue::reset()</a>, <a class="el" href="os-thread_8cpp_source.html#l00357">os::rtos::Thread::sched_prio()</a>, <a class="el" href="os-semaphore_8cpp_source.html#l00077">Semaphore()</a>, <a class="el" href="os-mqueue_8cpp_source.html#l00156">os::rtos::Message_queue::send()</a>, <a class="el" href="os-thread_8cpp_source.html#l00710">os::rtos::Thread::sig_clear()</a>, <a class="el" href="os-thread_8cpp_source.html#l00679">os::rtos::Thread::sig_get()</a>, <a class="el" href="os-thread_8cpp_source.html#l00647">os::rtos::Thread::sig_raise()</a>, <a class="el" href="os-thread_8cpp_source.html#l00794">os::rtos::Thread::sig_wait()</a>, <a class="el" href="os-thread_8cpp_source.html#l00292">os::rtos::Thread::suspend()</a>, <a class="el" href="os-thread_8cpp_source.html#l00206">os::rtos::Thread::Thread()</a>, <a class="el" href="os-mempool_8cpp_source.html#l00218">os::rtos::Memory_pool::timed_alloc()</a>, <a class="el" href="os-mqueue_8cpp_source.html#l00445">os::rtos::Message_queue::timed_receive()</a>, <a class="el" href="os-mqueue_8cpp_source.html#l00267">os::rtos::Message_queue::timed_send()</a>, <a class="el" href="os-thread_8cpp_source.html#l00887">os::rtos::Thread::timed_sig_wait()</a>, <a class="el" href="os-semaphore_8cpp_source.html#l00333">timed_wait()</a>, <a class="el" href="os-timer_8cpp_source.html#l00070">os::rtos::Timer::Timer()</a>, <a class="el" href="os-mempool_8cpp_source.html#l00201">os::rtos::Memory_pool::try_alloc()</a>, <a class="el" href="os-mqueue_8cpp_source.html#l00376">os::rtos::Message_queue::try_receive()</a>, <a class="el" href="os-mqueue_8cpp_source.html#l00205">os::rtos::Message_queue::try_send()</a>, <a class="el" href="os-thread_8cpp_source.html#l00841">os::rtos::Thread::try_sig_wait()</a>, <a class="el" href="os-semaphore_8cpp_source.html#l00280">try_wait()</a>, <a class="el" href="os-semaphore_8cpp_source.html#l00229">wait()</a>, <a class="el" href="os-thread_8cpp_source.html#l00314">os::rtos::Thread::wakeup()</a>, <a class="el" href="os-mempool_8cpp_source.html#l00116">os::rtos::Memory_pool::~Memory_pool()</a>, <a class="el" href="os-mqueue_8cpp_source.html#l00106">os::rtos::Message_queue::~Message_queue()</a>, and <a class="el" href="os-semaphore_8cpp_source.html#l00120">~Semaphore()</a>.</p>
<div class="fragment"><div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;    {</div><div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classos_1_1rtos_1_1_named__object.html#a7c6435f5bbc1c2793664672cbf420d70">name_</a>;</div><div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;    }</div><div class="ttc" id="classos_1_1rtos_1_1_named__object_html_a7c6435f5bbc1c2793664672cbf420d70"><div class="ttname"><a href="classos_1_1rtos_1_1_named__object.html#a7c6435f5bbc1c2793664672cbf420d70">os::rtos::Named_object::name_</a></div><div class="ttdeci">const char *const name_</div><div class="ttdef"><b>Definition:</b> <a href="os_8h_source.html#l00529">os.h:529</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="afad6784d1a323aa1e9b8f07513950aca"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classos_1_1rtos_1_1_semaphore.html">Semaphore</a>&amp; os::rtos::Semaphore::operator= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classos_1_1rtos_1_1_semaphore.html">Semaphore</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a4ae185ebe3909b86d5b531d34664ca94"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classos_1_1rtos_1_1_semaphore.html">Semaphore</a>&amp; os::rtos::Semaphore::operator= </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classos_1_1rtos_1_1_semaphore.html">Semaphore</a> &amp;&amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ae0e0c778fd520d792ce171ed0568ed28"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool os::rtos::Semaphore::operator== </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classos_1_1rtos_1_1_semaphore.html">Semaphore</a> &amp;&#160;</td>
          <td class="paramname"><em>rhs</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Compare semaphores. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">true</td><td>The given semaphore is the same as this semaphore. </td></tr>
    <tr><td class="paramname">false</td><td>The semaphores are different.</td></tr>
  </table>
  </dd>
</dl>
<p>Identical semaphores should have the same memory address. </p>

<p>Definition at line <a class="el" href="os_8h_source.html#l02840">2840</a> of file <a class="el" href="os_8h_source.html">os.h</a>.</p>
<div class="fragment"><div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;    {</div><div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">this</span> == &amp;rhs;</div><div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;    }</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="add305af99c6d539ca210cd88cdc0c295"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceos_1_1rtos.html#a54633089ccffe9e56ce1137ebe57776d">result_t</a> os::rtos::Semaphore::post </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Post (unlock) the semaphore. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="namespaceos_1_1rtos_1_1result.html#a1f5b41a48ca4ac9f7aeb3bd1c702b45aac3daa6d58a1202b112a91628d144685b">result::ok</a></td><td>The semaphore was posted. </td></tr>
    <tr><td class="paramname">EOVERFLOW</td><td>The max count was exceeded. </td></tr>
    <tr><td class="paramname">ENOTRECOVERABLE</td><td>The semaphore could not be posted (extension to POSIX).</td></tr>
  </table>
  </dd>
</dl>
<p>Performe a post operation on the semaphore, informing the waiting consumers that one more resource is available. The semaphore count is incremented, up to max_count.</p>
<p>If the semaphore count resulting from this operation is positive, then no threads were blocked waiting for the semaphore to become unlocked.</p>
<p>If the count of the semaphore resulting from this operation is zero, then one of the threads blocked waiting for the semaphore shall be allowed to return successfully from its call to <a class="el" href="classos_1_1rtos_1_1_semaphore.html#a2740c2b8f9f596cc6255599068f20f98" title="Lock the semaphore, possibly waiting. ">Semaphore::wait()</a>.</p>
<p>If the Process Scheduling option is supported, the thread to be unblocked shall be chosen in a manner appropriate to the scheduling policies and parameters in effect for the blocked threads. In the case of the schedulers SCHED_FIFO and SCHED_RR, the highest priority waiting thread shall be unblocked, and if there is more than one highest priority thread blocked waiting for the semaphore, then the highest priority thread that has been waiting the longest shall be unblocked. If the Process Scheduling option is not defined, the choice of a thread to unblock is unspecified. If the scheduling policy is SCHED_SPORADIC, the semantics are as per SCHED_FIFO.</p>
<p>Compatible with POSIX <code>sem_post()</code> <a href="http://pubs.opengroup.org/onlinepubs/9699919799/functions/sem_post.html">http://pubs.opengroup.org/onlinepubs/9699919799/functions/sem_post.html</a></p>
<dl class="section note"><dt>Note</dt><dd>Can be invoked from Interrupt Service Routines.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Applications using these functions may be subject to priority inversion. </dd></dl>

<p>Definition at line <a class="el" href="os-semaphore_8cpp_source.html#l00171">171</a> of file <a class="el" href="os-semaphore_8cpp_source.html">os-semaphore.cpp</a>.</p>

<p>References <a class="el" href="os_8h_source.html#l01732">count_</a>, <a class="el" href="os_8h_source.html#l01721">list_</a>, <a class="el" href="os_8h_source.html#l01735">max_count_</a>, <a class="el" href="os_8h_source.html#l02531">os::rtos::Named_object::name()</a>, <a class="el" href="os_8h_source.html#l00101">os::rtos::result::ok</a>, and <a class="el" href="namespaceos_1_1trace.html#ab99139b69af4fe6f063b4a236133b2ee">os::trace::printf()</a>.</p>
<div class="fragment"><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    {</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;      <a class="code" href="namespaceos_1_1trace.html#ab99139b69af4fe6f063b4a236133b2ee">trace::printf</a> (<span class="stringliteral">&quot;%s() @%p %s\n&quot;</span>, __func__, <span class="keyword">this</span>, <a class="code" href="classos_1_1rtos_1_1_named__object.html#a1ced578ffc847e14547b02ee1473c44e">name</a> ());</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="preprocessor">#if defined(OS_INCLUDE_PORT_RTOS_SEMAPHORE)</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      <span class="keywordflow">return</span> port::Semaphore::post (<span class="keyword">this</span>);</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      interrupts::Critical_section cs; <span class="comment">// ----- Critical section -----</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classos_1_1rtos_1_1_semaphore.html#ad7a6486c35b35956d9a0fb729719121a">count_</a> &gt;= this-&gt;<a class="code" href="classos_1_1rtos_1_1_semaphore.html#a189e07ad643c937c8f705bce4c48bac1">max_count_</a>)</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        {</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;          <span class="keywordflow">return</span> EOVERFLOW;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        }</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      ++<a class="code" href="classos_1_1rtos_1_1_semaphore.html#ad7a6486c35b35956d9a0fb729719121a">count_</a>;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classos_1_1rtos_1_1_semaphore.html#ad7a6486c35b35956d9a0fb729719121a">count_</a> == 0)</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        {</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;          <span class="comment">// Wakeup one thread</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="classos_1_1rtos_1_1_semaphore.html#a1b69a387f9889eca15969d326cbaeb45">list_</a>.get_length () &gt; 0)</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;            {</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;              <a class="code" href="classos_1_1rtos_1_1_semaphore.html#a1b69a387f9889eca15969d326cbaeb45">list_</a>.get_top ()-&gt;wakeup ();</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            }</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        }</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespaceos_1_1rtos_1_1result.html#a1f5b41a48ca4ac9f7aeb3bd1c702b45aac3daa6d58a1202b112a91628d144685b">result::ok</a>;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    }</div><div class="ttc" id="classos_1_1rtos_1_1_named__object_html_a1ced578ffc847e14547b02ee1473c44e"><div class="ttname"><a href="classos_1_1rtos_1_1_named__object.html#a1ced578ffc847e14547b02ee1473c44e">os::rtos::Named_object::name</a></div><div class="ttdeci">const char * name(void) const </div><div class="ttdef"><b>Definition:</b> <a href="os_8h_source.html#l02531">os.h:2531</a></div></div>
<div class="ttc" id="classos_1_1rtos_1_1_semaphore_html_a1b69a387f9889eca15969d326cbaeb45"><div class="ttname"><a href="classos_1_1rtos_1_1_semaphore.html#a1b69a387f9889eca15969d326cbaeb45">os::rtos::Semaphore::list_</a></div><div class="ttdeci">port::Tasks_list list_</div><div class="ttdef"><b>Definition:</b> <a href="os_8h_source.html#l01721">os.h:1721</a></div></div>
<div class="ttc" id="namespaceos_1_1rtos_1_1result_html_a1f5b41a48ca4ac9f7aeb3bd1c702b45aac3daa6d58a1202b112a91628d144685b"><div class="ttname"><a href="namespaceos_1_1rtos_1_1result.html#a1f5b41a48ca4ac9f7aeb3bd1c702b45aac3daa6d58a1202b112a91628d144685b">os::rtos::result::ok</a></div><div class="ttdef"><b>Definition:</b> <a href="os_8h_source.html#l00101">os.h:101</a></div></div>
<div class="ttc" id="classos_1_1rtos_1_1_semaphore_html_a189e07ad643c937c8f705bce4c48bac1"><div class="ttname"><a href="classos_1_1rtos_1_1_semaphore.html#a189e07ad643c937c8f705bce4c48bac1">os::rtos::Semaphore::max_count_</a></div><div class="ttdeci">const semaphore::count_t max_count_</div><div class="ttdef"><b>Definition:</b> <a href="os_8h_source.html#l01735">os.h:1735</a></div></div>
<div class="ttc" id="namespaceos_1_1trace_html_ab99139b69af4fe6f063b4a236133b2ee"><div class="ttname"><a href="namespaceos_1_1trace.html#ab99139b69af4fe6f063b4a236133b2ee">os::trace::printf</a></div><div class="ttdeci">int printf(const char *format,...)</div></div>
<div class="ttc" id="classos_1_1rtos_1_1_semaphore_html_ad7a6486c35b35956d9a0fb729719121a"><div class="ttname"><a href="classos_1_1rtos_1_1_semaphore.html#ad7a6486c35b35956d9a0fb729719121a">os::rtos::Semaphore::count_</a></div><div class="ttdeci">volatile semaphore::count_t count_</div><div class="ttdef"><b>Definition:</b> <a href="os_8h_source.html#l01732">os.h:1732</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad855a37723270b019c47cc90d23cddff"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceos_1_1rtos.html#a54633089ccffe9e56ce1137ebe57776d">result_t</a> os::rtos::Semaphore::reset </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reset the semaphore. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="namespaceos_1_1rtos_1_1result.html#a1f5b41a48ca4ac9f7aeb3bd1c702b45aac3daa6d58a1202b112a91628d144685b">result::ok</a></td><td>The semaphore was reset. </td></tr>
    <tr><td class="paramname">EPERM</td><td>Cannot be invoked from an Interrupt Service Routine.</td></tr>
  </table>
  </dd>
</dl>
<p>Set the counter to the initial value.</p>
<dl class="section warning"><dt>Warning</dt><dd>Cannot be invoked from Interrupt Service Routines. </dd></dl>

<p>Definition at line <a class="el" href="os-semaphore_8cpp_source.html#l00377">377</a> of file <a class="el" href="os-semaphore_8cpp_source.html">os-semaphore.cpp</a>.</p>

<p>References <a class="el" href="os_8h_source.html#l01732">count_</a>, <a class="el" href="os-core_8cpp_source.html#l00068">os::rtos::scheduler::in_handler_mode()</a>, <a class="el" href="os_8h_source.html#l01729">initial_count_</a>, <a class="el" href="os_8h_source.html#l00101">os::rtos::result::ok</a>, <a class="el" href="os_8h_source.html#l03032">os_assert_err</a>, and <a class="el" href="usb-device_8h_source.html#l00131">os::driver::usb::device::reset</a>.</p>
<div class="fragment"><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    {</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;      <a class="code" href="os_8h.html#ae9cede0de19446e3a5eb930b6b10dd39">os_assert_err</a>(!<a class="code" href="namespaceos_1_1rtos_1_1scheduler.html#a72474ad9ad219abeb13fb3ed0b95a8b3">scheduler::in_handler_mode</a> (), EPERM);</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="preprocessor">#if defined(OS_INCLUDE_PORT_RTOS_SEMAPHORE)</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespaceos_1_1driver_1_1usb_1_1device.html#ac271252f96010635939d3fcb301ba435a3a865208c4a08af6742d949564fc560a">port::Semaphore::reset</a> (<span class="keyword">this</span>);</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;      interrupts::Critical_section cs; <span class="comment">// ----- Critical section -----</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classos_1_1rtos_1_1_semaphore.html#ad7a6486c35b35956d9a0fb729719121a">count_</a> &lt; 0)</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        {</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;          <span class="comment">// There are waiting tasks</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;          <span class="keywordflow">return</span> EAGAIN;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        }</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;      <a class="code" href="classos_1_1rtos_1_1_semaphore.html#ad7a6486c35b35956d9a0fb729719121a">count_</a> = <a class="code" href="classos_1_1rtos_1_1_semaphore.html#a1038bfe269c0f83b11b9c8c359c24640">initial_count_</a>;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespaceos_1_1rtos_1_1result.html#a1f5b41a48ca4ac9f7aeb3bd1c702b45aac3daa6d58a1202b112a91628d144685b">result::ok</a>;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    }</div><div class="ttc" id="os_8h_html_ae9cede0de19446e3a5eb930b6b10dd39"><div class="ttname"><a href="os_8h.html#ae9cede0de19446e3a5eb930b6b10dd39">os_assert_err</a></div><div class="ttdeci">#define os_assert_err(__e, __er)</div><div class="ttdef"><b>Definition:</b> <a href="os_8h_source.html#l03032">os.h:3032</a></div></div>
<div class="ttc" id="classos_1_1rtos_1_1_semaphore_html_a1038bfe269c0f83b11b9c8c359c24640"><div class="ttname"><a href="classos_1_1rtos_1_1_semaphore.html#a1038bfe269c0f83b11b9c8c359c24640">os::rtos::Semaphore::initial_count_</a></div><div class="ttdeci">const semaphore::count_t initial_count_</div><div class="ttdef"><b>Definition:</b> <a href="os_8h_source.html#l01729">os.h:1729</a></div></div>
<div class="ttc" id="namespaceos_1_1rtos_1_1result_html_a1f5b41a48ca4ac9f7aeb3bd1c702b45aac3daa6d58a1202b112a91628d144685b"><div class="ttname"><a href="namespaceos_1_1rtos_1_1result.html#a1f5b41a48ca4ac9f7aeb3bd1c702b45aac3daa6d58a1202b112a91628d144685b">os::rtos::result::ok</a></div><div class="ttdef"><b>Definition:</b> <a href="os_8h_source.html#l00101">os.h:101</a></div></div>
<div class="ttc" id="namespaceos_1_1rtos_1_1scheduler_html_a72474ad9ad219abeb13fb3ed0b95a8b3"><div class="ttname"><a href="namespaceos_1_1rtos_1_1scheduler.html#a72474ad9ad219abeb13fb3ed0b95a8b3">os::rtos::scheduler::in_handler_mode</a></div><div class="ttdeci">bool in_handler_mode(void)</div><div class="ttdoc">Check if in handler mode. </div><div class="ttdef"><b>Definition:</b> <a href="os-core_8cpp_source.html#l00068">os-core.cpp:68</a></div></div>
<div class="ttc" id="classos_1_1rtos_1_1_semaphore_html_ad7a6486c35b35956d9a0fb729719121a"><div class="ttname"><a href="classos_1_1rtos_1_1_semaphore.html#ad7a6486c35b35956d9a0fb729719121a">os::rtos::Semaphore::count_</a></div><div class="ttdeci">volatile semaphore::count_t count_</div><div class="ttdef"><b>Definition:</b> <a href="os_8h_source.html#l01732">os.h:1732</a></div></div>
<div class="ttc" id="namespaceos_1_1driver_1_1usb_1_1device_html_ac271252f96010635939d3fcb301ba435a3a865208c4a08af6742d949564fc560a"><div class="ttname"><a href="namespaceos_1_1driver_1_1usb_1_1device.html#ac271252f96010635939d3fcb301ba435a3a865208c4a08af6742d949564fc560a">os::driver::usb::device::reset</a></div><div class="ttdoc">USB switch to High Speed occurred. </div><div class="ttdef"><b>Definition:</b> <a href="usb-device_8h_source.html#l00131">usb-device.h:131</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a13155e1bf1c700001f0ee6a7f39ec6ff"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceos_1_1rtos.html#a54633089ccffe9e56ce1137ebe57776d">result_t</a> os::rtos::Semaphore::timed_wait </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceos_1_1rtos.html#aba7f568590671eed574e70d3a38de2df">systicks_t</a>&#160;</td>
          <td class="paramname"><em>ticks</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Timed wait to lock the semaphore. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ticks</td><td>Number of ticks to wait. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="namespaceos_1_1rtos_1_1result.html#a1f5b41a48ca4ac9f7aeb3bd1c702b45aac3daa6d58a1202b112a91628d144685b">result::ok</a></td><td>The calling process successfully performed the semaphore lock operation. </td></tr>
    <tr><td class="paramname">EPERM</td><td>Cannot be invoked from an Interrupt Service Routine. </td></tr>
    <tr><td class="paramname">EINVAL</td><td>Invalid timeout (POSIX limits the timeout to 1000 million ns) </td></tr>
    <tr><td class="paramname">ETIMEDOUT</td><td>The semaphore could not be locked before the specified timeout expired. </td></tr>
    <tr><td class="paramname">ENOTRECOVERABLE</td><td><a class="el" href="classos_1_1rtos_1_1_semaphore.html" title="POSIX semaphore. ">Semaphore</a> wait failed (extension to POSIX). </td></tr>
    <tr><td class="paramname">EDEADLK</td><td>A deadlock condition was detected. </td></tr>
    <tr><td class="paramname">EINTR</td><td>The operation was interrupted.</td></tr>
  </table>
  </dd>
</dl>
<p>Try to perform a lock operation; if the semaphore cannot be locked without waiting for another process or thread to unlock the semaphore by performing a <a class="el" href="classos_1_1rtos_1_1_semaphore.html#add305af99c6d539ca210cd88cdc0c295" title="Post (unlock) the semaphore. ">Semaphore::post()</a> function, this wait shall be terminated when the specified timeout expires.</p>
<p>The timeout shall expire after the number of time units (that is when the value of that clock equals or exceeds (now()+duration). The resolution of the timeout shall be the resolution of the clock on which it is based (the SysTick clock for CMSIS).</p>
<p>Under no circumstance shall the function fail with a timeout if the semaphore can be locked immediately. The validity of the timeout need not be checked if the semaphore can be locked immediately.</p>
<p>Compatible with POSIX <code>sem_timedwait()</code>, except the time point is replaced with a duration. <a href="http://pubs.opengroup.org/onlinepubs/9699919799/functions/sem_timedwait.html">http://pubs.opengroup.org/onlinepubs/9699919799/functions/sem_timedwait.html</a></p>
<dl class="section warning"><dt>Warning</dt><dd>Cannot be invoked from Interrupt Service Routines.</dd>
<dd>
Applications using these functions may be subject to priority inversion. </dd></dl>

<p>Definition at line <a class="el" href="os-semaphore_8cpp_source.html#l00333">333</a> of file <a class="el" href="os-semaphore_8cpp_source.html">os-semaphore.cpp</a>.</p>

<p>References <a class="el" href="os_8h_source.html#l01732">count_</a>, <a class="el" href="os-core_8cpp_source.html#l00068">os::rtos::scheduler::in_handler_mode()</a>, <a class="el" href="os_8h_source.html#l01721">list_</a>, <a class="el" href="os_8h_source.html#l02531">os::rtos::Named_object::name()</a>, <a class="el" href="os_8h_source.html#l00101">os::rtos::result::ok</a>, <a class="el" href="os_8h_source.html#l03032">os_assert_err</a>, <a class="el" href="namespaceos_1_1trace.html#ab99139b69af4fe6f063b4a236133b2ee">os::trace::printf()</a>, <a class="el" href="os-thread_8cpp_source.html#l00065">os::rtos::this_thread::thread()</a>, and <a class="el" href="os-clocks_8cpp_source.html#l00258">os::rtos::Systick_clock::wait()</a>.</p>
<div class="fragment"><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    {</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;      <a class="code" href="os_8h.html#ae9cede0de19446e3a5eb930b6b10dd39">os_assert_err</a>(!<a class="code" href="namespaceos_1_1rtos_1_1scheduler.html#a72474ad9ad219abeb13fb3ed0b95a8b3">scheduler::in_handler_mode</a> (), EPERM);</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;      <a class="code" href="namespaceos_1_1trace.html#ab99139b69af4fe6f063b4a236133b2ee">trace::printf</a> (<span class="stringliteral">&quot;%s(%d_ticks) @%p %s\n&quot;</span>, __func__, ticks, <span class="keyword">this</span>, <a class="code" href="classos_1_1rtos_1_1_named__object.html#a1ced578ffc847e14547b02ee1473c44e">name</a> ());</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;      <span class="keywordflow">if</span> (ticks == 0)</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        {</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;          ticks = 1;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        }</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="preprocessor">#if defined(OS_INCLUDE_PORT_RTOS_SEMAPHORE)</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      <span class="keywordflow">return</span> port::Semaphore::timed_wait (<span class="keyword">this</span>, ticks);</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        {</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;          interrupts::Critical_section cs; <span class="comment">// ----- Critical section -----</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;          --<a class="code" href="classos_1_1rtos_1_1_semaphore.html#ad7a6486c35b35956d9a0fb729719121a">count_</a>;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="classos_1_1rtos_1_1_semaphore.html#ad7a6486c35b35956d9a0fb729719121a">count_</a> &gt;= 0)</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;            {</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;              <span class="keywordflow">return</span> <a class="code" href="namespaceos_1_1rtos_1_1result.html#a1f5b41a48ca4ac9f7aeb3bd1c702b45aac3daa6d58a1202b112a91628d144685b">result::ok</a>;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;            }</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;          <span class="comment">// Add current thread to the semaphore waiting list.</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;          <a class="code" href="classos_1_1rtos_1_1_semaphore.html#a1b69a387f9889eca15969d326cbaeb45">list_</a>.add (&amp;<a class="code" href="namespaceos_1_1rtos_1_1this__thread.html#a527cca157e8ac579442f34a1a88589c9">this_thread::thread</a> ());</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        }</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;      <a class="code" href="classos_1_1rtos_1_1_systick__clock.html#a9fab09f31761d68d67f1d7add321f7c6">Systick_clock::wait</a> (ticks);</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      <span class="comment">// TODO: return EINTR</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;      <span class="keywordflow">return</span> ETIMEDOUT;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    }</div><div class="ttc" id="os_8h_html_ae9cede0de19446e3a5eb930b6b10dd39"><div class="ttname"><a href="os_8h.html#ae9cede0de19446e3a5eb930b6b10dd39">os_assert_err</a></div><div class="ttdeci">#define os_assert_err(__e, __er)</div><div class="ttdef"><b>Definition:</b> <a href="os_8h_source.html#l03032">os.h:3032</a></div></div>
<div class="ttc" id="classos_1_1rtos_1_1_named__object_html_a1ced578ffc847e14547b02ee1473c44e"><div class="ttname"><a href="classos_1_1rtos_1_1_named__object.html#a1ced578ffc847e14547b02ee1473c44e">os::rtos::Named_object::name</a></div><div class="ttdeci">const char * name(void) const </div><div class="ttdef"><b>Definition:</b> <a href="os_8h_source.html#l02531">os.h:2531</a></div></div>
<div class="ttc" id="classos_1_1rtos_1_1_semaphore_html_a1b69a387f9889eca15969d326cbaeb45"><div class="ttname"><a href="classos_1_1rtos_1_1_semaphore.html#a1b69a387f9889eca15969d326cbaeb45">os::rtos::Semaphore::list_</a></div><div class="ttdeci">port::Tasks_list list_</div><div class="ttdef"><b>Definition:</b> <a href="os_8h_source.html#l01721">os.h:1721</a></div></div>
<div class="ttc" id="namespaceos_1_1rtos_1_1this__thread_html_a527cca157e8ac579442f34a1a88589c9"><div class="ttname"><a href="namespaceos_1_1rtos_1_1this__thread.html#a527cca157e8ac579442f34a1a88589c9">os::rtos::this_thread::thread</a></div><div class="ttdeci">Thread &amp; thread(void)</div><div class="ttdoc">Get current thread. </div><div class="ttdef"><b>Definition:</b> <a href="os-thread_8cpp_source.html#l00065">os-thread.cpp:65</a></div></div>
<div class="ttc" id="namespaceos_1_1rtos_1_1result_html_a1f5b41a48ca4ac9f7aeb3bd1c702b45aac3daa6d58a1202b112a91628d144685b"><div class="ttname"><a href="namespaceos_1_1rtos_1_1result.html#a1f5b41a48ca4ac9f7aeb3bd1c702b45aac3daa6d58a1202b112a91628d144685b">os::rtos::result::ok</a></div><div class="ttdef"><b>Definition:</b> <a href="os_8h_source.html#l00101">os.h:101</a></div></div>
<div class="ttc" id="classos_1_1rtos_1_1_systick__clock_html_a9fab09f31761d68d67f1d7add321f7c6"><div class="ttname"><a href="classos_1_1rtos_1_1_systick__clock.html#a9fab09f31761d68d67f1d7add321f7c6">os::rtos::Systick_clock::wait</a></div><div class="ttdeci">static result_t wait(sleep_rep ticks)</div><div class="ttdoc">Wait for an event. </div><div class="ttdef"><b>Definition:</b> <a href="os-clocks_8cpp_source.html#l00258">os-clocks.cpp:258</a></div></div>
<div class="ttc" id="namespaceos_1_1rtos_1_1scheduler_html_a72474ad9ad219abeb13fb3ed0b95a8b3"><div class="ttname"><a href="namespaceos_1_1rtos_1_1scheduler.html#a72474ad9ad219abeb13fb3ed0b95a8b3">os::rtos::scheduler::in_handler_mode</a></div><div class="ttdeci">bool in_handler_mode(void)</div><div class="ttdoc">Check if in handler mode. </div><div class="ttdef"><b>Definition:</b> <a href="os-core_8cpp_source.html#l00068">os-core.cpp:68</a></div></div>
<div class="ttc" id="namespaceos_1_1trace_html_ab99139b69af4fe6f063b4a236133b2ee"><div class="ttname"><a href="namespaceos_1_1trace.html#ab99139b69af4fe6f063b4a236133b2ee">os::trace::printf</a></div><div class="ttdeci">int printf(const char *format,...)</div></div>
<div class="ttc" id="classos_1_1rtos_1_1_semaphore_html_ad7a6486c35b35956d9a0fb729719121a"><div class="ttname"><a href="classos_1_1rtos_1_1_semaphore.html#ad7a6486c35b35956d9a0fb729719121a">os::rtos::Semaphore::count_</a></div><div class="ttdeci">volatile semaphore::count_t count_</div><div class="ttdef"><b>Definition:</b> <a href="os_8h_source.html#l01732">os.h:1732</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a27f748424126707fde0cc1de41c01a48"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceos_1_1rtos.html#a54633089ccffe9e56ce1137ebe57776d">result_t</a> os::rtos::Semaphore::try_wait </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Try to lock the semaphore. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="namespaceos_1_1rtos_1_1result.html#a1f5b41a48ca4ac9f7aeb3bd1c702b45aac3daa6d58a1202b112a91628d144685b">result::ok</a></td><td>The calling process successfully performed the semaphore lock operation. </td></tr>
    <tr><td class="paramname">EPERM</td><td>Cannot be invoked from an Interrupt Service Routine. </td></tr>
    <tr><td class="paramname">EAGAIN</td><td>The semaphore was already locked. </td></tr>
    <tr><td class="paramname">ENOTRECOVERABLE</td><td><a class="el" href="classos_1_1rtos_1_1_semaphore.html" title="POSIX semaphore. ">Semaphore</a> wait failed (extension to POSIX). </td></tr>
    <tr><td class="paramname">EDEADLK</td><td>A deadlock condition was detected. </td></tr>
    <tr><td class="paramname">EINTR</td><td>The operation was interrupted.</td></tr>
  </table>
  </dd>
</dl>
<p>Tries to perform a lock operation only if the semaphore is currently not locked; that is, if the semaphore value is currently positive it decrements it and returns success. Otherwise, it shall not lock the semaphore.</p>
<p>Upon successful return, the state of the semaphore shall be locked and shall remain locked until the <a class="el" href="classos_1_1rtos_1_1_semaphore.html#add305af99c6d539ca210cd88cdc0c295" title="Post (unlock) the semaphore. ">post()</a> function is executed and returns successfully.</p>
<p>Compatible with POSIX <code>sem_trywait()</code>. <a href="http://pubs.opengroup.org/onlinepubs/9699919799/functions/sem_wait.html">http://pubs.opengroup.org/onlinepubs/9699919799/functions/sem_wait.html</a></p>
<dl class="section note"><dt>Note</dt><dd>Can be invoked from Interrupt Service Routines.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Applications using these functions may be subject to priority inversion. </dd></dl>

<p>Definition at line <a class="el" href="os-semaphore_8cpp_source.html#l00280">280</a> of file <a class="el" href="os-semaphore_8cpp_source.html">os-semaphore.cpp</a>.</p>

<p>References <a class="el" href="os_8h_source.html#l01732">count_</a>, <a class="el" href="os_8h_source.html#l02531">os::rtos::Named_object::name()</a>, <a class="el" href="os_8h_source.html#l00101">os::rtos::result::ok</a>, and <a class="el" href="namespaceos_1_1trace.html#ab99139b69af4fe6f063b4a236133b2ee">os::trace::printf()</a>.</p>
<div class="fragment"><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    {</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;      <a class="code" href="namespaceos_1_1trace.html#ab99139b69af4fe6f063b4a236133b2ee">trace::printf</a> (<span class="stringliteral">&quot;%s() @%p %s\n&quot;</span>, __func__, <span class="keyword">this</span>, <a class="code" href="classos_1_1rtos_1_1_named__object.html#a1ced578ffc847e14547b02ee1473c44e">name</a> ());</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="preprocessor">#if defined(OS_INCLUDE_PORT_RTOS_SEMAPHORE)</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;      <span class="keywordflow">return</span> port::Semaphore::try_wait (<span class="keyword">this</span>);</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        {</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;          interrupts::Critical_section cs; <span class="comment">// ----- Critical section -----</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="classos_1_1rtos_1_1_semaphore.html#ad7a6486c35b35956d9a0fb729719121a">count_</a> &gt; 0)</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;            {</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;              --<a class="code" href="classos_1_1rtos_1_1_semaphore.html#ad7a6486c35b35956d9a0fb729719121a">count_</a>;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;              <span class="keywordflow">return</span> <a class="code" href="namespaceos_1_1rtos_1_1result.html#a1f5b41a48ca4ac9f7aeb3bd1c702b45aac3daa6d58a1202b112a91628d144685b">result::ok</a>;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;            }</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;          <span class="comment">// Count may be 0 or negative</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;          <span class="keywordflow">return</span> EAGAIN;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        }</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    }</div><div class="ttc" id="classos_1_1rtos_1_1_named__object_html_a1ced578ffc847e14547b02ee1473c44e"><div class="ttname"><a href="classos_1_1rtos_1_1_named__object.html#a1ced578ffc847e14547b02ee1473c44e">os::rtos::Named_object::name</a></div><div class="ttdeci">const char * name(void) const </div><div class="ttdef"><b>Definition:</b> <a href="os_8h_source.html#l02531">os.h:2531</a></div></div>
<div class="ttc" id="namespaceos_1_1rtos_1_1result_html_a1f5b41a48ca4ac9f7aeb3bd1c702b45aac3daa6d58a1202b112a91628d144685b"><div class="ttname"><a href="namespaceos_1_1rtos_1_1result.html#a1f5b41a48ca4ac9f7aeb3bd1c702b45aac3daa6d58a1202b112a91628d144685b">os::rtos::result::ok</a></div><div class="ttdef"><b>Definition:</b> <a href="os_8h_source.html#l00101">os.h:101</a></div></div>
<div class="ttc" id="namespaceos_1_1trace_html_ab99139b69af4fe6f063b4a236133b2ee"><div class="ttname"><a href="namespaceos_1_1trace.html#ab99139b69af4fe6f063b4a236133b2ee">os::trace::printf</a></div><div class="ttdeci">int printf(const char *format,...)</div></div>
<div class="ttc" id="classos_1_1rtos_1_1_semaphore_html_ad7a6486c35b35956d9a0fb729719121a"><div class="ttname"><a href="classos_1_1rtos_1_1_semaphore.html#ad7a6486c35b35956d9a0fb729719121a">os::rtos::Semaphore::count_</a></div><div class="ttdeci">volatile semaphore::count_t count_</div><div class="ttdef"><b>Definition:</b> <a href="os_8h_source.html#l01732">os.h:1732</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="afaad1f1047d7d46f5baf5329d35ca78d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceos_1_1rtos_1_1semaphore.html#af1d385ca401f753ae725118254291409">semaphore::count_t</a> os::rtos::Semaphore::value </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the semaphore value. </p>
<dl class="section return"><dt>Returns</dt><dd>The semaphore value.</dd></dl>
<p>If positive, the semaphore value reflects the number of available resources. If negative, it counts the waiting tasks. </p>

<p>Definition at line <a class="el" href="os_8h_source.html#l02851">2851</a> of file <a class="el" href="os_8h_source.html">os.h</a>.</p>
<div class="fragment"><div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;    {</div><div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classos_1_1rtos_1_1_semaphore.html#ad7a6486c35b35956d9a0fb729719121a">count_</a>;</div><div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;    }</div><div class="ttc" id="classos_1_1rtos_1_1_semaphore_html_ad7a6486c35b35956d9a0fb729719121a"><div class="ttname"><a href="classos_1_1rtos_1_1_semaphore.html#ad7a6486c35b35956d9a0fb729719121a">os::rtos::Semaphore::count_</a></div><div class="ttdeci">volatile semaphore::count_t count_</div><div class="ttdef"><b>Definition:</b> <a href="os_8h_source.html#l01732">os.h:1732</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2740c2b8f9f596cc6255599068f20f98"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceos_1_1rtos.html#a54633089ccffe9e56ce1137ebe57776d">result_t</a> os::rtos::Semaphore::wait </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Lock the semaphore, possibly waiting. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="namespaceos_1_1rtos_1_1result.html#a1f5b41a48ca4ac9f7aeb3bd1c702b45aac3daa6d58a1202b112a91628d144685b">result::ok</a></td><td>The calling process successfully performed the semaphore lock operation. </td></tr>
    <tr><td class="paramname">EPERM</td><td>Cannot be invoked from an Interrupt Service Routine. </td></tr>
    <tr><td class="paramname">ENOTRECOVERABLE</td><td><a class="el" href="classos_1_1rtos_1_1_semaphore.html" title="POSIX semaphore. ">Semaphore</a> wait failed (extension to POSIX). </td></tr>
    <tr><td class="paramname">EDEADLK</td><td>A deadlock condition was detected. </td></tr>
    <tr><td class="paramname">EINTR</td><td>The operation was interrupted.</td></tr>
  </table>
  </dd>
</dl>
<p>Perform a lock operation on the semaphore.</p>
<p>If the current value is positive, it is decremented, and the call returns immediately</p>
<p>If the semaphore value is currently zero, then the calling thread shall not return from the call to <a class="el" href="classos_1_1rtos_1_1_semaphore.html#a2740c2b8f9f596cc6255599068f20f98" title="Lock the semaphore, possibly waiting. ">wait()</a> until it either locks the semaphore or the call is interrupted by a signal.</p>
<p>Upon successful return, the state of the semaphore shall be locked and shall remain locked until the <a class="el" href="classos_1_1rtos_1_1_semaphore.html#add305af99c6d539ca210cd88cdc0c295" title="Post (unlock) the semaphore. ">post()</a> function is executed and returns successfully.</p>
<p>The function is interruptible by the delivery of an external event (signal, thread cancel, etc).</p>
<p>Compatible with POSIX <code>sem_wait()</code>. <a href="http://pubs.opengroup.org/onlinepubs/9699919799/functions/sem_wait.html">http://pubs.opengroup.org/onlinepubs/9699919799/functions/sem_wait.html</a></p>
<dl class="section warning"><dt>Warning</dt><dd>Cannot be invoked from Interrupt Service Routines.</dd>
<dd>
Applications using these functions may be subject to priority inversion. </dd></dl>

<p>Definition at line <a class="el" href="os-semaphore_8cpp_source.html#l00229">229</a> of file <a class="el" href="os-semaphore_8cpp_source.html">os-semaphore.cpp</a>.</p>

<p>References <a class="el" href="os_8h_source.html#l01732">count_</a>, <a class="el" href="os-core_8cpp_source.html#l00068">os::rtos::scheduler::in_handler_mode()</a>, <a class="el" href="os_8h_source.html#l01721">list_</a>, <a class="el" href="os_8h_source.html#l02531">os::rtos::Named_object::name()</a>, <a class="el" href="os_8h_source.html#l00101">os::rtos::result::ok</a>, <a class="el" href="os_8h_source.html#l03032">os_assert_err</a>, <a class="el" href="namespaceos_1_1trace.html#ab99139b69af4fe6f063b4a236133b2ee">os::trace::printf()</a>, <a class="el" href="os-thread_8cpp_source.html#l00065">os::rtos::this_thread::thread()</a>, and <a class="el" href="os-thread_8cpp_source.html#l00087">os::rtos::this_thread::yield()</a>.</p>
<div class="fragment"><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    {</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      <a class="code" href="os_8h.html#ae9cede0de19446e3a5eb930b6b10dd39">os_assert_err</a>(!<a class="code" href="namespaceos_1_1rtos_1_1scheduler.html#a72474ad9ad219abeb13fb3ed0b95a8b3">scheduler::in_handler_mode</a> (), EPERM);</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      <a class="code" href="namespaceos_1_1trace.html#ab99139b69af4fe6f063b4a236133b2ee">trace::printf</a> (<span class="stringliteral">&quot;%s() @%p %s\n&quot;</span>, __func__, <span class="keyword">this</span>, <a class="code" href="classos_1_1rtos_1_1_named__object.html#a1ced578ffc847e14547b02ee1473c44e">name</a> ());</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="preprocessor">#if defined(OS_INCLUDE_PORT_RTOS_SEMAPHORE)</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      <span class="keywordflow">return</span> port::Semaphore::wait (<span class="keyword">this</span>);</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        {</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;          interrupts::Critical_section cs; <span class="comment">// ----- Critical section ------</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;          --<a class="code" href="classos_1_1rtos_1_1_semaphore.html#ad7a6486c35b35956d9a0fb729719121a">count_</a>;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="classos_1_1rtos_1_1_semaphore.html#ad7a6486c35b35956d9a0fb729719121a">count_</a> &gt;= 0)</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            {</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;              <span class="keywordflow">return</span> <a class="code" href="namespaceos_1_1rtos_1_1result.html#a1f5b41a48ca4ac9f7aeb3bd1c702b45aac3daa6d58a1202b112a91628d144685b">result::ok</a>;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;            }</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;          <span class="comment">// Add current thread to the semaphore waiting  list</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;          <a class="code" href="classos_1_1rtos_1_1_semaphore.html#a1b69a387f9889eca15969d326cbaeb45">list_</a>.add (&amp;<a class="code" href="namespaceos_1_1rtos_1_1this__thread.html#a527cca157e8ac579442f34a1a88589c9">this_thread::thread</a> ());</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;          <span class="comment">// `count_` is negative.</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        }</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      <a class="code" href="namespaceos_1_1rtos_1_1this__thread.html#a6d6b2df07994ab81b2435596a93bbdb6">this_thread::yield</a> ();</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;      <span class="comment">// Return EINTR?</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespaceos_1_1rtos_1_1result.html#a1f5b41a48ca4ac9f7aeb3bd1c702b45aac3daa6d58a1202b112a91628d144685b">result::ok</a>;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    }</div><div class="ttc" id="namespaceos_1_1rtos_1_1this__thread_html_a6d6b2df07994ab81b2435596a93bbdb6"><div class="ttname"><a href="namespaceos_1_1rtos_1_1this__thread.html#a6d6b2df07994ab81b2435596a93bbdb6">os::rtos::this_thread::yield</a></div><div class="ttdeci">void yield(void)</div><div class="ttdoc">Yield CPU. </div><div class="ttdef"><b>Definition:</b> <a href="os-thread_8cpp_source.html#l00087">os-thread.cpp:87</a></div></div>
<div class="ttc" id="os_8h_html_ae9cede0de19446e3a5eb930b6b10dd39"><div class="ttname"><a href="os_8h.html#ae9cede0de19446e3a5eb930b6b10dd39">os_assert_err</a></div><div class="ttdeci">#define os_assert_err(__e, __er)</div><div class="ttdef"><b>Definition:</b> <a href="os_8h_source.html#l03032">os.h:3032</a></div></div>
<div class="ttc" id="classos_1_1rtos_1_1_named__object_html_a1ced578ffc847e14547b02ee1473c44e"><div class="ttname"><a href="classos_1_1rtos_1_1_named__object.html#a1ced578ffc847e14547b02ee1473c44e">os::rtos::Named_object::name</a></div><div class="ttdeci">const char * name(void) const </div><div class="ttdef"><b>Definition:</b> <a href="os_8h_source.html#l02531">os.h:2531</a></div></div>
<div class="ttc" id="classos_1_1rtos_1_1_semaphore_html_a1b69a387f9889eca15969d326cbaeb45"><div class="ttname"><a href="classos_1_1rtos_1_1_semaphore.html#a1b69a387f9889eca15969d326cbaeb45">os::rtos::Semaphore::list_</a></div><div class="ttdeci">port::Tasks_list list_</div><div class="ttdef"><b>Definition:</b> <a href="os_8h_source.html#l01721">os.h:1721</a></div></div>
<div class="ttc" id="namespaceos_1_1rtos_1_1this__thread_html_a527cca157e8ac579442f34a1a88589c9"><div class="ttname"><a href="namespaceos_1_1rtos_1_1this__thread.html#a527cca157e8ac579442f34a1a88589c9">os::rtos::this_thread::thread</a></div><div class="ttdeci">Thread &amp; thread(void)</div><div class="ttdoc">Get current thread. </div><div class="ttdef"><b>Definition:</b> <a href="os-thread_8cpp_source.html#l00065">os-thread.cpp:65</a></div></div>
<div class="ttc" id="namespaceos_1_1rtos_1_1result_html_a1f5b41a48ca4ac9f7aeb3bd1c702b45aac3daa6d58a1202b112a91628d144685b"><div class="ttname"><a href="namespaceos_1_1rtos_1_1result.html#a1f5b41a48ca4ac9f7aeb3bd1c702b45aac3daa6d58a1202b112a91628d144685b">os::rtos::result::ok</a></div><div class="ttdef"><b>Definition:</b> <a href="os_8h_source.html#l00101">os.h:101</a></div></div>
<div class="ttc" id="namespaceos_1_1rtos_1_1scheduler_html_a72474ad9ad219abeb13fb3ed0b95a8b3"><div class="ttname"><a href="namespaceos_1_1rtos_1_1scheduler.html#a72474ad9ad219abeb13fb3ed0b95a8b3">os::rtos::scheduler::in_handler_mode</a></div><div class="ttdeci">bool in_handler_mode(void)</div><div class="ttdoc">Check if in handler mode. </div><div class="ttdef"><b>Definition:</b> <a href="os-core_8cpp_source.html#l00068">os-core.cpp:68</a></div></div>
<div class="ttc" id="namespaceos_1_1trace_html_ab99139b69af4fe6f063b4a236133b2ee"><div class="ttname"><a href="namespaceos_1_1trace.html#ab99139b69af4fe6f063b4a236133b2ee">os::trace::printf</a></div><div class="ttdeci">int printf(const char *format,...)</div></div>
<div class="ttc" id="classos_1_1rtos_1_1_semaphore_html_ad7a6486c35b35956d9a0fb729719121a"><div class="ttname"><a href="classos_1_1rtos_1_1_semaphore.html#ad7a6486c35b35956d9a0fb729719121a">os::rtos::Semaphore::count_</a></div><div class="ttdeci">volatile semaphore::count_t count_</div><div class="ttdef"><b>Definition:</b> <a href="os_8h_source.html#l01732">os.h:1732</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="ad7a6486c35b35956d9a0fb729719121a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="semihosting_8h.html#a32ef937c1076c2ef6b0f929bc187c1cb">volatile</a> <a class="el" href="namespaceos_1_1rtos_1_1semaphore.html#af1d385ca401f753ae725118254291409">semaphore::count_t</a> os::rtos::Semaphore::count_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="os_8h_source.html#l01732">1732</a> of file <a class="el" href="os_8h_source.html">os.h</a>.</p>

<p>Referenced by <a class="el" href="os-semaphore_8cpp_source.html#l00171">post()</a>, <a class="el" href="os-semaphore_8cpp_source.html#l00377">reset()</a>, <a class="el" href="os-semaphore_8cpp_source.html#l00077">Semaphore()</a>, <a class="el" href="os-semaphore_8cpp_source.html#l00333">timed_wait()</a>, <a class="el" href="os-semaphore_8cpp_source.html#l00280">try_wait()</a>, and <a class="el" href="os-semaphore_8cpp_source.html#l00229">wait()</a>.</p>

</div>
</div>
<a class="anchor" id="a1038bfe269c0f83b11b9c8c359c24640"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="namespaceos_1_1rtos_1_1semaphore.html#af1d385ca401f753ae725118254291409">semaphore::count_t</a> os::rtos::Semaphore::initial_count_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="os_8h_source.html#l01729">1729</a> of file <a class="el" href="os_8h_source.html">os.h</a>.</p>

<p>Referenced by <a class="el" href="os-semaphore_8cpp_source.html#l00377">reset()</a>, and <a class="el" href="os-semaphore_8cpp_source.html#l00077">Semaphore()</a>.</p>

</div>
</div>
<a class="anchor" id="a1b69a387f9889eca15969d326cbaeb45"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">port::Tasks_list os::rtos::Semaphore::list_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="os_8h_source.html#l01721">1721</a> of file <a class="el" href="os_8h_source.html">os.h</a>.</p>

<p>Referenced by <a class="el" href="os-semaphore_8cpp_source.html#l00171">post()</a>, <a class="el" href="os-semaphore_8cpp_source.html#l00333">timed_wait()</a>, and <a class="el" href="os-semaphore_8cpp_source.html#l00229">wait()</a>.</p>

</div>
</div>
<a class="anchor" id="a189e07ad643c937c8f705bce4c48bac1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="namespaceos_1_1rtos_1_1semaphore.html#af1d385ca401f753ae725118254291409">semaphore::count_t</a> os::rtos::Semaphore::max_count_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="os_8h_source.html#l01735">1735</a> of file <a class="el" href="os_8h_source.html">os.h</a>.</p>

<p>Referenced by <a class="el" href="os-semaphore_8cpp_source.html#l00171">post()</a>, and <a class="el" href="os-semaphore_8cpp_source.html#l00077">Semaphore()</a>.</p>

</div>
</div>
<a class="anchor" id="a7c6435f5bbc1c2793664672cbf420d70"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const char* const os::rtos::Named_object::name_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="os_8h_source.html#l00529">529</a> of file <a class="el" href="os_8h_source.html">os.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>include/cmsis-plus/rtos/<a class="el" href="os_8h_source.html">os.h</a></li>
<li>src/cmsis-plus/rtos/<a class="el" href="os-semaphore_8cpp_source.html">os-semaphore.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceos.html">os</a></li><li class="navelem"><a class="el" href="namespaceos_1_1rtos.html">rtos</a></li><li class="navelem"><a class="el" href="classos_1_1rtos_1_1_semaphore.html">Semaphore</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
